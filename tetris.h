#include "garfield.h"
#include "math.h"

#ifndef TETRIS
#define TETRIS

namespace tetris
{

const uint16_t logo[] = {0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 32, 31493, 50374, 16803, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 18915,
                         56647, 65030, 65030, 65030, 44069, 8418, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 10498, 48262, 65030, 65030, 65030,
                         65030, 65030, 65030, 62950, 33605, 2112, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 2145, 37797, 65030, 65030, 65030, 65030, 65030, 65030, 65030,
                         65030, 65030, 65030, 58759, 23108, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 10530, 60839,
                         65030, 65030, 65030, 65030, 65030, 65030, 65030, 65030, 65030, 65030,
                         65030, 65030, 65030, 46215, 32, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 23109, 12642, 52455, 65030,
                         65030, 65030, 65030, 65030, 65030, 65030, 65030, 65030, 65030, 64998,
                         37797, 8418, 16803, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 65097, 52455, 12610, 23140, 58759, 65030,
                         65030, 65030, 65030, 65030, 65030, 65030, 48294, 12611, 27300, 60838,
                         37797, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 65097, 65030, 65030, 41958, 8418, 35685, 62950, 65030,
                         65030, 65030, 56646, 21028, 16803, 54566, 65030, 65030, 37797, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         65097, 65030, 65030, 65030, 60838, 29412, 10531, 46182, 62951, 31492,
                         10498, 44070, 65030, 65030, 65030, 65030, 37797, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 65097, 65030,
                         65030, 65030, 65030, 65030, 56646, 18915, 4225, 33605, 64999, 65030,
                         65030, 65030, 65030, 65030, 37797, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 65097, 65030, 65030, 65030,
                         65030, 65030, 65030, 56647, 16836, 65030, 65030, 65030, 65030, 65030,
                         65030, 65030, 37797, 0, 0, 0, 0, 0, 0, 0,
                         2242, 5003, 4679, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 65097, 65030, 65030, 65030, 65030, 65030,
                         65030, 56647, 16836, 65030, 65030, 65030, 65030, 65030, 65030, 65030,
                         37797, 0, 0, 0, 0, 0, 65, 4841, 3376, 1360,
                         1360, 5262, 2404, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 65097, 65030, 65030, 65030, 65030, 65030, 65030, 56647,
                         16836, 65030, 65030, 65030, 65030, 65030, 65030, 65030, 37797, 0,
                         0, 0, 0, 4647, 3311, 1360, 1360, 1360, 1360, 1360,
                         1360, 5035, 2242, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         65097, 65030, 65030, 65030, 65030, 65030, 65030, 56647, 16836, 65030,
                         65030, 65030, 65030, 65030, 65030, 65030, 37797, 0, 0, 2372,
                         5197, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
                         1327, 4809, 64, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 48327, 65030,
                         65030, 65030, 65030, 65030, 65030, 56647, 16836, 65030, 65030, 65030,
                         65030, 65030, 65030, 64999, 25188, 0, 7019, 1360, 1360, 1360,
                         1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
                         3279, 4452, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 16836, 21028, 56646, 65030,
                         65030, 65030, 65030, 56647, 16836, 65030, 65030, 65030, 65030, 65030,
                         46182, 8450, 4776, 4841, 4355, 5003, 1360, 1360, 1360, 1360,
                         1360, 1360, 1360, 1360, 1360, 1360, 1360, 3311, 4614, 4452,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 65097, 44070, 10498, 31493, 62919, 65030,
                         65030, 56647, 16836, 65030, 65030, 65030, 54566, 16835, 4549, 3246,
                         1360, 1360, 3279, 4615, 4452, 5229, 1360, 1360, 1360, 1360,
                         1360, 1360, 1360, 3376, 4841, 2242, 5003, 5489, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 65097, 65030, 62950, 33605, 8418, 41990, 65030, 56647,
                         16836, 65030, 60839, 27300, 4355, 5133, 1360, 1360, 1360, 1360,
                         1360, 1360, 5197, 4420, 4647, 3311, 1360, 1360, 1360, 1360,
                         5068, 2275, 4776, 3376, 1360, 3440, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         65097, 65030, 65030, 65030, 58759, 23108, 14691, 41990, 14723, 37797,
                         6370, 4906, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
                         1360, 1360, 4970, 2242, 4874, 1328, 3214, 4485, 4582, 3246,
                         1360, 1360, 1360, 3440, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 65097, 65030,
                         65030, 65030, 65030, 65030, 50374, 12642, 0, 4614, 3343, 1360,
                         1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
                         1360, 3376, 4679, 2210, 2307, 5133, 1360, 1360, 1360, 1360,
                         1360, 3440, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 2113, 31269, 22948, 0, 0,
                         0, 0, 0, 0, 0, 0, 65097, 65030, 65030, 65030,
                         65030, 65030, 65030, 56647, 2210, 2275, 4841, 1328, 1360, 1360,
                         1360, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 3408, 4906,
                         4355, 2210, 7310, 1360, 1360, 1360, 1360, 1360, 1360, 3440,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 22948, 56200, 62408, 62408, 49992, 12547, 0, 0,
                         0, 0, 0, 0, 65097, 65030, 65030, 65030, 65030, 65030,
                         65030, 56647, 6565, 3343, 4776, 2307, 5068, 1360, 1360, 1360,
                         1360, 1360, 1360, 1360, 1360, 5133, 2307, 4744, 3311, 4549,
                         7310, 1360, 1360, 1360, 1360, 1360, 1360, 3440, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 12547, 47911,
                         62408, 62408, 62408, 62408, 62408, 62408, 39590, 6273, 0, 0,
                         0, 0, 65097, 65030, 65030, 65030, 65030, 65030, 65030, 56647,
                         6565, 1360, 1360, 3214, 4550, 4485, 5262, 1360, 1360, 1360,
                         1360, 5326, 4549, 4485, 5262, 1360, 1360, 4549, 7310, 1360,
                         1360, 1360, 1360, 1360, 1360, 3440, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 4193, 37510, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 58280, 29222, 32, 0, 0,
                         65097, 65030, 65030, 65030, 65030, 65030, 65030, 56647, 6565, 1360,
                         1360, 1360, 1360, 5132, 4355, 4712, 3343, 3376, 4776, 2275,
                         5100, 1360, 1360, 1360, 1360, 4549, 7310, 1360, 1360, 1360,
                         1360, 1360, 1360, 3440, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 27142, 60360, 62408, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 54152, 14627, 0, 54600, 65030,
                         65030, 65030, 65030, 65030, 65030, 56647, 6565, 1360, 1360, 1360,
                         1360, 1360, 1328, 4906, 4323, 2242, 4873, 3376, 1360, 1360,
                         1360, 1360, 1360, 4549, 7310, 1360, 1360, 1360, 1360, 1360,
                         1360, 5327, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 18788, 29189, 8386,
                         43751, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 60360, 33349, 8386, 2113, 10531, 27300, 60871, 65030,
                         65030, 65030, 65030, 56647, 6565, 1360, 1360, 1360, 1360, 1360,
                         1360, 1360, 4938, 6954, 1360, 1360, 1360, 1360, 1360, 1360,
                         1360, 4549, 7310, 1360, 1360, 1360, 1360, 3343, 4776, 4323,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 10434, 45831, 62408, 62408, 54152, 18820, 14627,
                         52072, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 43751,
                         10499, 29221, 60328, 8386, 65065, 37797, 8386, 37830, 65030, 65030,
                         65030, 56647, 6565, 1360, 1360, 1360, 1360, 1360, 1360, 1360,
                         4938, 6922, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 4549,
                         7310, 1360, 1360, 1328, 5003, 2275, 4841, 5489, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 4193,
                         35430, 60328, 62408, 62408, 62408, 62408, 62408, 45831, 10466, 27109,
                         58280, 62408, 62408, 62408, 62408, 52072, 16707, 18820, 54120, 62408,
                         62408, 8386, 65097, 65030, 60838, 27268, 12610, 48262, 65030, 56647,
                         6565, 1360, 1360, 1360, 1360, 1360, 1360, 1360, 4938, 6922,
                         1360, 1360, 1360, 1360, 1360, 1360, 1360, 4549, 7310, 1360,
                         5197, 4420, 4647, 3279, 1360, 3440, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 25028, 58248, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 62408, 62408, 35430, 8386, 35462,
                         60360, 58280, 27109, 10467, 45831, 62408, 62408, 62408, 62408, 8386,
                         65097, 65030, 65030, 65030, 54567, 16803, 20995, 48295, 6565, 1360,
                         1360, 1360, 1360, 1360, 1360, 1360, 4938, 6922, 1360, 1360,
                         1360, 1360, 1360, 1360, 1360, 4549, 9261, 4647, 2372, 5229,
                         1360, 1360, 1360, 3440, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 12547, 52040, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 62408, 58248, 25061, 10434, 8386,
                         35430, 60360, 62408, 62408, 62408, 62408, 62408, 8386, 65097, 65030,
                         65030, 65030, 65030, 65030, 44069, 6305, 4388, 1295, 1360, 1360,
                         1360, 1360, 1360, 1360, 4938, 6922, 1360, 1360, 1360, 1360,
                         1360, 1360, 3376, 2372, 2210, 5003, 1360, 1360, 1360, 1360,
                         1360, 3440, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 6305, 29221,
                         8386, 35430, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 45831, 10466, 4193, 43784, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 8386, 65097, 65030, 65030, 65030,
                         65030, 60871, 27300, 4356, 10858, 4323, 5003, 1360, 1360, 1360,
                         1360, 1360, 4938, 6922, 1360, 1360, 1360, 1360, 1360, 5067,
                         2275, 10729, 4324, 4647, 3311, 1360, 1360, 1360, 1360, 3440,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 2080, 31302, 60360, 62408, 58280, 27109,
                         10434, 45864, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 62408,
                         54152, 18787, 14659, 52072, 24996, 43784, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 8386, 65097, 65030, 65030, 65030, 37829, 6338,
                         13036, 15539, 15539, 15442, 8679, 2372, 5230, 1360, 1360, 1360,
                         4938, 6922, 1360, 1360, 1360, 5262, 2404, 8551, 15153, 13139,
                         13139, 10861, 4291, 4873, 3376, 1360, 1360, 3440, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 20900, 56200, 62408, 62408, 62408, 62408, 62408, 52072, 16675,
                         18788, 54120, 62408, 62408, 62408, 62408, 60328, 29221, 8386, 41671,
                         62408, 62408, 24996, 43784, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 8386, 65097, 65030, 48262, 12610, 8712, 15474, 15539, 15539,
                         15539, 15539, 15539, 15344, 4388, 4647, 3311, 1360, 4938, 6922,
                         1360, 3311, 4711, 4292, 12975, 13139, 13139, 13139, 13139, 13139,
                         15187, 10730, 4355, 5100, 1360, 3440, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 12547, 47912, 62408,
                         62408, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 43751, 10434,
                         29189, 60360, 62408, 39591, 10467, 31302, 60360, 62408, 62408, 62408,
                         24996, 43784, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 8386,
                         56713, 21028, 6502, 15376, 15539, 15539, 15539, 15539, 15539, 15539,
                         15539, 15539, 15539, 13101, 4291, 4874, 4906, 6922, 4906, 4291,
                         10828, 15219, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139,
                         15121, 6470, 2437, 7375, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 4193, 37510, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 62408, 62408, 60360, 33350, 8354,
                         12579, 22948, 56200, 62408, 62408, 62408, 62408, 62408, 24996, 43784,
                         62408, 62408, 62408, 62408, 62408, 62408, 60360, 6306, 6371, 13133,
                         15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539,
                         15539, 15539, 15474, 10825, 32, 2113, 8649, 13106, 13139, 13139,
                         13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139,
                         12975, 4259, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 6306, 29221, 58280, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 56200, 22980, 4225, 25061, 62408,
                         62408, 62408, 62408, 62408, 62408, 62408, 24996, 43784, 62408, 62408,
                         62408, 62408, 62408, 39590, 6338, 65, 6371, 10923, 15507, 15539,
                         15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539,
                         15409, 8615, 2178, 4226, 6437, 13073, 13139, 13139, 13139, 13139,
                         13139, 13139, 13139, 13139, 13139, 13139, 13139, 15219, 10796, 4291,
                         8617, 2145, 0, 0, 0, 0, 0, 0, 0, 52137,
                         33349, 8419, 37510, 62408, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 60360, 33350, 8386, 39590, 43718, 27141, 62408, 62408, 62408,
                         62408, 62408, 62408, 62408, 24996, 43784, 62408, 62408, 62408, 49992,
                         12547, 8680, 15442, 4323, 19667, 10858, 6404, 13133, 15539, 15539,
                         15539, 15539, 15539, 15539, 15539, 15539, 15507, 8777, 4356, 13166,
                         10988, 12875, 12974, 6372, 8649, 15186, 13139, 13139, 13139, 13139,
                         13139, 13139, 13139, 13139, 15055, 4291, 8649, 15186, 13139, 13106,
                         8616, 32, 0, 0, 0, 0, 0, 54185, 62408, 56200,
                         22981, 12547, 47912, 62408, 62408, 62408, 62408, 62408, 43751, 10434,
                         27109, 60360, 62408, 43718, 27141, 62408, 62408, 62408, 62408, 62408,
                         62408, 62408, 24996, 43784, 62408, 56200, 22948, 4388, 13263, 15539,
                         15539, 4323, 19700, 15539, 15409, 8615, 6502, 15376, 15539, 15539,
                         15539, 15539, 15539, 13101, 4291, 10923, 15507, 15539, 10988, 10795,
                         13139, 13139, 10828, 4291, 10828, 15219, 13139, 13139, 13139, 13139,
                         15121, 6470, 6437, 13073, 13139, 13139, 13139, 13139, 13139, 15120,
                         6405, 0, 0, 0, 0, 54185, 62408, 62408, 62408, 49959,
                         14627, 20900, 56232, 62408, 52072, 16708, 18788, 54120, 62408, 62408,
                         62408, 43718, 27141, 62408, 62408, 62408, 62408, 62408, 62408, 62408,
                         24996, 43784, 33350, 4291, 13101, 15539, 15539, 15539, 15539, 4323,
                         19700, 15539, 15539, 15539, 15279, 4356, 8744, 15506, 15539, 15344,
                         4388, 8680, 15442, 15539, 15539, 15539, 10988, 10795, 13139, 13139,
                         13139, 15186, 8617, 4292, 13007, 13139, 15187, 10730, 4291, 12974,
                         13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 12941,
                         4259, 0, 0, 54185, 62408, 62408, 62408, 62408, 62408, 39623,
                         8354, 20900, 10434, 45831, 62408, 62408, 62408, 62408, 62408, 43718,
                         27141, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 20868, 2145,
                         10857, 15474, 15539, 15539, 15539, 15539, 15539, 4323, 19700, 15539,
                         15539, 15539, 15539, 15539, 13068, 4291, 8647, 6436, 15311, 15539,
                         15539, 15539, 15539, 15539, 10988, 10795, 13139, 13139, 13139, 13139,
                         13139, 13040, 6405, 6470, 4291, 10763, 15187, 13139, 13139, 13139,
                         13139, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 15187, 10730,
                         32, 54185, 62408, 62408, 62408, 62408, 62408, 62408, 58313, 6338,
                         62408, 62408, 62408, 62408, 62408, 62408, 62408, 43718, 27141, 62408,
                         62408, 62408, 62408, 62408, 52072, 16707, 2113, 2145, 8744, 15474,
                         15539, 15539, 15539, 15539, 15539, 4323, 19700, 15539, 15539, 15539,
                         15539, 15539, 15539, 17457, 6469, 15539, 15539, 15539, 15539, 15539,
                         15539, 15539, 10988, 10795, 13139, 13139, 13139, 13139, 13139, 13139,
                         13139, 6438, 2145, 10730, 15187, 13139, 13139, 13139, 13139, 13139,
                         13139, 13139, 13139, 13139, 13139, 13139, 13106, 10730, 2145, 54185,
                         62408, 62408, 62408, 62408, 62408, 62408, 60360, 8419, 62408, 62408,
                         62408, 62408, 62408, 62408, 62408, 43718, 27141, 62408, 62408, 62408,
                         58280, 25029, 10499, 45831, 24996, 15279, 10955, 4323, 10988, 15507,
                         15539, 15539, 15539, 4323, 19700, 15539, 15539, 15539, 15539, 15539,
                         15539, 15409, 8582, 15539, 15539, 15539, 15539, 15539, 15539, 15539,
                         10988, 10795, 13139, 13139, 13139, 13139, 13139, 13139, 13139, 6470,
                         17201, 10762, 4291, 10861, 13139, 13139, 13139, 13139, 13139, 13139,
                         13139, 13139, 15219, 10828, 4324, 10763, 13007, 54185, 62408, 62408,
                         62408, 62408, 62408, 62408, 60360, 8419, 62408, 62408, 62408, 62408,
                         62408, 62408, 62408, 43718, 27141, 62408, 62408, 35430, 8386, 35430,
                         60360, 62408, 24996, 15246, 15539, 15474, 8745, 4356, 15279, 15539,
                         15539, 4323, 19700, 15539, 15539, 15539, 15539, 15539, 15539, 15409,
                         8582, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 10988, 10795,
                         13139, 13139, 13139, 13139, 13139, 13139, 13139, 6470, 15153, 13139,
                         15154, 8584, 4324, 15088, 13139, 13139, 13139, 13139, 13139, 13040,
                         6372, 8616, 15154, 13139, 13007, 54185, 62408, 62408, 62408, 62408,
                         62408, 62408, 60360, 8419, 62408, 62408, 62408, 62408, 62408, 62408,
                         62408, 43718, 27141, 47912, 10466, 25061, 58280, 62408, 62408, 62408,
                         24996, 15246, 15539, 15539, 15539, 15376, 6501, 8615, 15377, 4323,
                         19700, 15539, 15539, 15539, 15539, 15539, 15539, 15409, 8582, 15539,
                         15539, 15539, 15539, 15539, 15539, 15539, 10988, 10795, 13139, 13139,
                         13139, 13139, 13139, 13139, 13139, 6470, 15153, 13139, 13139, 13139,
                         13008, 6405, 8584, 15186, 13139, 15154, 8583, 6405, 13040, 13139,
                         13139, 13139, 13007, 52105, 62408, 62408, 62408, 62408, 62408, 62408,
                         60360, 8419, 62408, 62408, 62408, 62408, 62408, 62408, 62408, 41670,
                         4193, 14627, 52040, 62408, 62408, 62408, 62408, 62408, 24996, 15246,
                         15539, 15539, 15539, 15539, 15539, 13166, 4323, 65, 19667, 15539,
                         15539, 15539, 15539, 15539, 15539, 15409, 8582, 15539, 15539, 15539,
                         15539, 15539, 15539, 15539, 13003, 10763, 13139, 13139, 13139, 13139,
                         13139, 13139, 13139, 6470, 15153, 13139, 13139, 13139, 13139, 13139,
                         12909, 4291, 8616, 4259, 10861, 13171, 13139, 13139, 13139, 13139,
                         13007, 4193, 33349, 62408, 62408, 62408, 62408, 62408, 60360, 8419,
                         62408, 62408, 62408, 62408, 62408, 60360, 29221, 32, 0, 18788,
                         54120, 62408, 62408, 62408, 62408, 62408, 24996, 15246, 15539, 15539,
                         15539, 15539, 15539, 15539, 15507, 4258, 4291, 13101, 15539, 15539,
                         15539, 15539, 15539, 15409, 8582, 15539, 15539, 15539, 15539, 15539,
                         15474, 8744, 4356, 4388, 8584, 15186, 13139, 13139, 13139, 13139,
                         13139, 6470, 15153, 13139, 13139, 13139, 13139, 13139, 13139, 15219,
                         4226, 15219, 13139, 13139, 13139, 13139, 13139, 13139, 13007, 0,
                         0, 10434, 45831, 62408, 62408, 62408, 60360, 8419, 62408, 62408,
                         62408, 62408, 39590, 6273, 0, 0, 0, 0, 32, 29189,
                         60360, 62408, 62408, 62408, 24996, 15246, 15539, 15539, 15539, 15539,
                         15539, 15539, 15539, 4323, 21683, 8679, 6437, 15312, 15539, 15539,
                         15539, 15409, 8582, 15539, 15539, 15539, 15507, 10988, 4291, 10987,
                         15539, 15539, 13101, 4259, 10795, 15187, 13139, 13139, 13139, 6470,
                         15153, 13139, 13139, 13139, 13139, 13139, 13139, 15252, 4259, 13139,
                         13139, 13139, 13139, 13139, 13139, 13139, 13007, 0, 0, 0,
                         0, 18755, 54152, 62408, 60360, 8419, 62408, 62408, 49992, 14627,
                         0, 0, 0, 0, 0, 0, 0, 0, 4193, 39591,
                         62408, 62408, 24996, 15246, 15539, 15539, 15539, 15539, 15539, 15539,
                         15539, 4323, 19700, 15539, 15312, 6437, 8679, 15474, 15539, 15409,
                         8582, 15539, 15539, 15279, 4356, 10825, 15474, 15539, 15539, 15539,
                         15539, 15507, 10857, 4291, 12974, 13139, 13139, 6470, 15153, 13139,
                         13139, 13139, 13139, 13139, 13139, 15252, 4259, 13139, 13139, 13139,
                         13139, 13139, 13139, 13139, 13007, 0, 0, 0, 0, 0,
                         32, 29189, 58281, 8419, 56232, 22948, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 12547, 47911,
                         24996, 15246, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 4323,
                         19700, 15539, 15539, 15539, 13068, 4291, 10923, 17457, 8582, 15409,
                         8615, 6502, 15376, 15539, 15539, 15539, 15539, 15539, 15539, 15539,
                         15539, 15409, 6566, 6438, 15121, 6470, 15153, 13139, 13139, 13139,
                         13139, 13139, 13139, 15252, 4259, 13139, 13139, 13139, 13139, 13139,
                         13139, 13139, 13007, 0, 0, 0, 0, 0, 0, 0,
                         4193, 2113, 2113, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 4193, 15214,
                         15539, 15539, 15539, 15539, 15539, 15539, 15539, 4323, 19700, 15539,
                         15539, 15539, 15539, 15506, 10858, 4258, 2145, 4323, 13166, 15539,
                         15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539,
                         15539, 15279, 4356, 2145, 15120, 13139, 13139, 13139, 13139, 13139,
                         13139, 15252, 4259, 13139, 13139, 13139, 13139, 13139, 13139, 13139,
                         13007, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 2113, 10890, 15507,
                         15539, 15539, 15539, 15539, 15539, 4323, 19700, 15539, 15539, 15539,
                         15539, 15539, 15539, 15311, 2113, 6469, 15377, 15539, 15539, 15539,
                         15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 15409,
                         6534, 32, 4259, 10796, 15220, 13139, 13139, 13139, 13139, 15252,
                         4259, 13139, 13139, 13139, 13139, 13139, 15219, 10796, 2113, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 4259, 13166, 15539,
                         15539, 15539, 15539, 4323, 19700, 15539, 15539, 15539, 15539, 15539,
                         15539, 15409, 8582, 15279, 4356, 8745, 15474, 15539, 15539, 15539,
                         15539, 15539, 15539, 15539, 15539, 15507, 8777, 4323, 13166, 6566,
                         17168, 8649, 4324, 13007, 13139, 13139, 13139, 15252, 4259, 13139,
                         13139, 13139, 13139, 12975, 4291, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 6501, 15377, 15539,
                         15539, 4323, 19700, 15539, 15539, 15539, 15539, 15539, 15539, 15409,
                         8582, 15539, 15507, 10988, 4291, 13036, 15539, 15539, 15539, 15539,
                         15539, 15539, 13101, 4291, 10955, 15539, 15539, 6566, 15153, 13139,
                         15120, 6437, 6503, 15154, 13139, 15252, 4259, 13139, 13139, 15153,
                         6438, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 8744, 15474, 4323,
                         19700, 15539, 15539, 15539, 15539, 15539, 15539, 15409, 8582, 15539,
                         15539, 15539, 15474, 8745, 4356, 13231, 15539, 15539, 15311, 6436,
                         8680, 15442, 15539, 15539, 15539, 6566, 15153, 13139, 13139, 13139,
                         12942, 4291, 10730, 17300, 4259, 15187, 10730, 32, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 65, 32, 19700, 15539,
                         15539, 15539, 15539, 15539, 15539, 15409, 8582, 15539, 15539, 15539,
                         15539, 15539, 15376, 6502, 6566, 8680, 6469, 15344, 15539, 15539,
                         15539, 15539, 15539, 6566, 15153, 13139, 13139, 13139, 13139, 15187,
                         10763, 4259, 32, 2178, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 4323, 13231, 15539, 15539,
                         15539, 15539, 15539, 15409, 8582, 15539, 15539, 15539, 15539, 15539,
                         15539, 15539, 8777, 10793, 15539, 15539, 15539, 15539, 15539, 15539,
                         15539, 6566, 15153, 13139, 13139, 13139, 13139, 13139, 15088, 4292,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 6566, 15409, 15539, 15539,
                         15539, 15409, 8582, 15539, 15539, 15539, 15539, 15539, 15539, 15539,
                         10988, 13003, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 6566,
                         15153, 13139, 13139, 13139, 15154, 8584, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 32, 10858, 15474, 15539, 15409,
                         8582, 15539, 15539, 15539, 15539, 15539, 15539, 15539, 10988, 13003,
                         15539, 15539, 15539, 15539, 15539, 15539, 15539, 6566, 15153, 13139,
                         15219, 10762, 33, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 2178, 13101, 17489, 8582, 15539,
                         15539, 15539, 15539, 15539, 15539, 15539, 10988, 13003, 15539, 15539,
                         15539, 15539, 15539, 15539, 15539, 6566, 17201, 12942, 4259, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 4291, 8582, 15539, 15539, 15539,
                         15539, 15539, 15539, 15539, 10988, 13003, 15539, 15539, 15539, 15539,
                         15539, 15539, 15539, 6566, 4292, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 8680, 15442, 15539, 15539, 15539,
                         15539, 15539, 10988, 13003, 15539, 15539, 15539, 15539, 15539, 15474,
                         8744, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 32, 10955, 15507, 15539, 15539, 15539,
                         10988, 13003, 15539, 15539, 15539, 15507, 10988, 2145, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 4291, 13166, 15539, 15539, 10988, 13003,
                         15539, 15539, 15279, 4323, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 6501, 15376, 10988, 13003, 15409, 8614,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 32, 4356, 4323, 32, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 14498, 18595, 18595, 18595, 18595, 18595, 18595, 18595, 18595,
                         18595, 18595, 18595, 18595, 18595, 6209, 6305, 20994, 20994, 20994,
                         20994, 18946, 0, 0, 0, 6241, 18595, 18595, 18595, 18595,
                         18595, 18595, 18595, 18595, 18595, 18595, 18595, 18595, 18595, 16611,
                         0, 4483, 6628, 6628, 6628, 6628, 6628, 6628, 6628, 4516,
                         4322, 0, 0, 0, 0, 0, 0, 2374, 4553, 4553,
                         4553, 4553, 2309, 0, 0, 0, 0, 0, 8356, 18761,
                         24972, 22891, 24972, 18794, 10469, 2113, 0, 0, 0, 47332,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 59620, 59620, 26722, 25251, 65089, 65089, 65089, 65089, 65091,
                         32, 0, 0, 22723, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 57734, 0, 9320,
                         9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 9416,
                         6789, 32, 0, 0, 0, 1047, 1309, 1309, 1309, 1309,
                         720, 0, 0, 0, 6275, 31247, 41556, 41556, 41556, 41556,
                         41556, 41556, 41556, 39507, 20842, 2145, 0, 47332, 59620, 59620,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 26722, 25251, 65089, 65089, 65089, 65089, 65091, 32, 0,
                         0, 22723, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 59620, 59620, 59620, 59620, 57734, 0, 9320, 9609, 9609,
                         9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 11304,
                         32, 0, 0, 1047, 1309, 1309, 1309, 1309, 720, 0,
                         0, 6307, 37426, 41556, 41556, 41556, 41556, 41556, 41556, 41556,
                         41556, 41556, 41556, 37458, 2113, 47332, 59620, 59620, 59620, 59620,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 26722,
                         25251, 65089, 65089, 65089, 65089, 65091, 32, 0, 0, 22723,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 59620, 59620, 57734, 0, 9320, 9609, 9609, 9609, 9609,
                         9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 8934, 0,
                         0, 1047, 1309, 1309, 1309, 1309, 720, 0, 0, 33328,
                         41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556,
                         41556, 22955, 0, 47332, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 26722, 25251, 65089,
                         65089, 65089, 65089, 65091, 32, 0, 0, 22723, 59620, 59620,
                         59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620, 59620,
                         59620, 57734, 0, 9320, 9609, 9609, 9609, 9609, 9609, 9609,
                         9609, 9609, 9609, 9609, 9609, 9609, 11561, 0, 0, 1047,
                         1309, 1309, 1309, 1309, 720, 0, 4226, 41556, 41556, 41556,
                         41556, 41556, 41556, 41620, 39507, 41556, 41556, 41556, 35409, 32,
                         0, 20675, 26819, 26819, 26819, 39140, 59620, 59620, 59620, 59620,
                         59620, 26819, 26819, 26819, 26819, 10338, 25251, 65089, 65089, 65089,
                         65089, 65091, 32, 0, 0, 10370, 26819, 26819, 26819, 26851,
                         57605, 59620, 59620, 59620, 59620, 43269, 26819, 26819, 26819, 24836,
                         0, 9320, 9609, 9609, 9609, 9609, 4773, 161, 4387, 9127,
                         9609, 9609, 9609, 9609, 9609, 4354, 0, 1047, 1309, 1309,
                         1309, 1309, 720, 0, 12550, 41556, 41556, 41556, 41556, 41556,
                         16744, 0, 32, 10469, 29199, 39507, 8356, 0, 0, 0,
                         0, 0, 0, 22593, 59620, 59620, 59620, 59620, 57540, 0,
                         0, 0, 0, 0, 25251, 65089, 65089, 65089, 65089, 65091,
                         32, 0, 0, 0, 0, 0, 0, 0, 55622, 59620,
                         59620, 59620, 59620, 28932, 0, 0, 0, 0, 0, 9320,
                         9609, 9609, 9609, 9609, 4644, 0, 0, 2209, 9609, 9609,
                         9609, 9609, 9609, 6596, 0, 1047, 1309, 1309, 1309, 1309,
                         720, 0, 12550, 41556, 41556, 41556, 41556, 41556, 29167, 14599,
                         6307, 2113, 0, 6307, 0, 0, 0, 0, 0, 0,
                         0, 22593, 59620, 59620, 59620, 59620, 57540, 0, 0, 0,
                         0, 0, 25251, 65089, 65089, 65089, 65089, 65089, 63012, 63044,
                         63044, 63044, 63044, 29444, 0, 0, 55622, 59620, 59620, 59620,
                         59620, 28932, 0, 0, 0, 0, 0, 9320, 9609, 9609,
                         9609, 9609, 4676, 0, 32, 8902, 9609, 9609, 9609, 9609,
                         9609, 4354, 0, 1047, 1309, 1309, 1309, 1309, 720, 0,
                         4194, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41588,
                         33296, 16680, 2113, 0, 0, 0, 0, 0, 0, 22593,
                         59620, 59620, 59620, 59620, 57540, 0, 0, 0, 0, 0,
                         25251, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089,
                         65089, 31490, 0, 0, 55622, 59620, 59620, 59620, 59620, 28932,
                         0, 0, 0, 0, 0, 9320, 9609, 9609, 9609, 9609,
                         9577, 11594, 9545, 9609, 9609, 9609, 9609, 9609, 9513, 0,
                         0, 1047, 1309, 1309, 1309, 1309, 720, 0, 0, 31215,
                         41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556,
                         37458, 8388, 0, 0, 0, 0, 0, 22593, 59620, 59620,
                         59620, 59620, 57540, 0, 0, 0, 0, 0, 25251, 65089,
                         65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 31490,
                         0, 0, 55622, 59620, 59620, 59620, 59620, 28932, 0, 0,
                         0, 0, 0, 9320, 9609, 9609, 9609, 9609, 9609, 9609,
                         9609, 9609, 9609, 9609, 9609, 9609, 8934, 0, 0, 1047,
                         1309, 1309, 1309, 1309, 720, 0, 0, 6275, 39507, 41556,
                         41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 37458,
                         2113, 0, 0, 0, 0, 22593, 59620, 59620, 59620, 59620,
                         57540, 0, 0, 0, 0, 0, 25251, 65089, 65089, 65089,
                         65089, 65089, 65089, 65089, 65089, 65089, 65089, 31490, 0, 0,
                         55622, 59620, 59620, 59620, 59620, 28932, 0, 0, 0, 0,
                         0, 9320, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609,
                         9609, 9609, 9609, 11304, 32, 0, 0, 1047, 1309, 1309,
                         1309, 1309, 720, 0, 0, 0, 6307, 29166, 41556, 41556,
                         41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 20874, 0,
                         0, 0, 0, 22593, 59620, 59620, 59620, 59620, 57540, 0,
                         0, 0, 0, 0, 25251, 65089, 65089, 65089, 65089, 65090,
                         29410, 29378, 29378, 29378, 29378, 12642, 0, 0, 55622, 59620,
                         59620, 59620, 59620, 28932, 0, 0, 0, 0, 0, 9320,
                         9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609, 9609,
                         11465, 32, 0, 0, 0, 1047, 1309, 1309, 1309, 1309,
                         720, 0, 0, 0, 0, 0, 4194, 16680, 24972, 31247,
                         39507, 41556, 41556, 41556, 41556, 41556, 29134, 0, 0, 0,
                         0, 22593, 59620, 59620, 59620, 59620, 57540, 0, 0, 0,
                         0, 0, 25251, 65089, 65089, 65089, 65089, 65091, 32, 0,
                         0, 0, 0, 0, 0, 0, 55622, 59620, 59620, 59620,
                         59620, 28932, 0, 0, 0, 0, 0, 9320, 9609, 9609,
                         9609, 9609, 7014, 6982, 9609, 9609, 9609, 9609, 9609, 4387,
                         0, 0, 0, 1047, 1309, 1309, 1309, 1309, 720, 0,
                         0, 0, 25004, 29166, 4194, 0, 0, 0, 32, 33296,
                         41556, 41556, 41556, 41556, 33297, 0, 0, 0, 0, 22593,
                         59620, 59620, 59620, 59620, 57540, 0, 0, 0, 0, 0,
                         25251, 65089, 65089, 65089, 65089, 65058, 27330, 27265, 27265, 27265,
                         27265, 27265, 18914, 0, 55622, 59620, 59620, 59620, 59620, 28932,
                         0, 0, 0, 0, 0, 9320, 9609, 9609, 9609, 9609,
                         4644, 2177, 9577, 9609, 9609, 9609, 9609, 9159, 0, 0,
                         0, 1047, 1309, 1309, 1309, 1309, 720, 0, 0, 16712,
                         41556, 41556, 39507, 25004, 16680, 14599, 18761, 39507, 41556, 41556,
                         41556, 41556, 29134, 0, 0, 0, 0, 22593, 59620, 59620,
                         59620, 59620, 57540, 0, 0, 0, 0, 0, 25251, 65089,
                         65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089,
                         48291, 0, 55622, 59620, 59620, 59620, 59620, 28932, 0, 0,
                         0, 0, 0, 9320, 9609, 9609, 9609, 9609, 4644, 0,
                         11240, 9609, 9609, 9609, 9609, 9577, 2209, 0, 0, 1047,
                         1309, 1309, 1309, 1309, 720, 0, 12550, 41556, 41556, 41556,
                         41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556, 41556,
                         20842, 0, 0, 0, 0, 22593, 59620, 59620, 59620, 59620,
                         57540, 0, 0, 0, 0, 0, 25251, 65089, 65089, 65089,
                         65089, 65089, 65089, 65089, 65089, 65089, 65089, 65089, 48291, 0,
                         55622, 59620, 59620, 59620, 59620, 28932, 0, 0, 0, 0,
                         0, 9320, 9609, 9609, 9609, 9609, 4644, 0, 4483, 9609,
                         9609, 9609, 9609, 9609, 9031, 0, 0, 1047, 1309, 1309,
                         1309, 1309, 720, 0, 37458, 41556, 41556, 41556, 41556, 41556,
                         41556, 41556, 41556, 41556, 41556, 41556, 41556, 37458, 2113, 0,
                         0, 0, 0, 22593, 59620, 59620, 59620, 59620, 57540, 0,
                         0, 0, 0, 0, 25251, 65089, 65089, 65089, 65089, 65089,
                         65089, 65089, 65089, 65089, 65089, 65089, 48291, 0, 55622, 59620,
                         59620, 59620, 59620, 28932, 0, 0, 0, 0, 0, 9320,
                         9609, 9609, 9609, 9609, 4644, 0, 0, 11465, 9609, 9609,
                         9609, 9609, 9513, 2177, 0, 1047, 1309, 1309, 1309, 1309,
                         720, 0, 6275, 33296, 41556, 41556, 41556, 41556, 41556, 41556,
                         41556, 41556, 41556, 41556, 37458, 8356, 0, 0, 0, 0,
                         0, 20578, 53508, 53508, 53508, 53508, 51461, 0, 0, 0,
                         0, 0, 23139, 58818, 58818, 58818, 58818, 58818, 58818, 58818,
                         58818, 58818, 58818, 58818, 44132, 0, 51590, 53508, 53508, 53508,
                         53508, 26884, 0, 0, 0, 0, 0, 9256, 9481, 9481,
                         9481, 9481, 6692, 0, 0, 6725, 9481, 9481, 9481, 9481,
                         9481, 6725, 0, 3029, 3258, 3258, 3258, 3258, 654, 0,
                         0, 0, 12518, 29166, 37458, 41556, 41556, 41556, 41556, 41556,
                         37458, 22923, 4194, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 32, 6275, 10437, 16712, 10437, 6275, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
                         0, 0, 0, 0, 0, 0, 0, 0, 0};
int logo_width = 78;
int logo_height = 96;

const uint8_t blocks[] = {
    1, 1, 0, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    1, 1, 0, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    1, 1, 0, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    1, 1, 0, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    /************************/
    0, 1, 0, 0,
    0, 1, 0, 0,
    0, 1, 0, 0,
    0, 1, 0, 0,

    0, 0, 0, 0,
    1, 1, 1, 1,
    0, 0, 0, 0,
    0, 0, 0, 0,

    0, 1, 0, 0,
    0, 1, 0, 0,
    0, 1, 0, 0,
    0, 1, 0, 0,

    0, 0, 0, 0,
    1, 1, 1, 1,
    0, 0, 0, 0,
    0, 0, 0, 0,
    /************************/
    0, 1, 0, 0,
    1, 1, 1, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    0, 1, 0, 0,
    0, 1, 1, 0,
    0, 1, 0, 0,
    0, 0, 0, 0,

    1, 1, 1, 0,
    0, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    0, 1, 0, 0,
    1, 1, 0, 0,
    0, 1, 0, 0,
    0, 0, 0, 0,

    /*******************/
    0, 1, 0, 0,
    1, 1, 0, 0,
    1, 0, 0, 0,
    0, 0, 0, 0,

    1, 1, 0, 0,
    0, 1, 1, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    0, 1, 0, 0,
    1, 1, 0, 0,
    1, 0, 0, 0,
    0, 0, 0, 0,

    1, 1, 0, 0,
    0, 1, 1, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,
    /****************************/
    1, 0, 0, 0,
    1, 1, 0, 0,
    0, 1, 0, 0,
    0, 0, 0, 0,

    0, 1, 1, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    1, 0, 0, 0,
    1, 1, 0, 0,
    0, 1, 0, 0,
    0, 0, 0, 0,

    0, 1, 1, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,
    /****************************/
    1, 1, 0, 0,
    0, 1, 0, 0,
    0, 1, 0, 0,
    0, 0, 0, 0,

    0, 0, 1, 0,
    1, 1, 1, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    1, 0, 0, 0,
    1, 0, 0, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,

    1, 1, 1, 0,
    1, 0, 0, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,
    /****************************/
    1, 1, 0, 0,
    1, 0, 0, 0,
    1, 0, 0, 0,
    0, 0, 0, 0,

    1, 1, 1, 0,
    0, 0, 1, 0,
    0, 0, 0, 0,
    0, 0, 0, 0,

    0, 1, 0, 0,
    0, 1, 0, 0,
    1, 1, 0, 0,
    0, 0, 0, 0,

    1, 0, 0, 0,
    1, 1, 1, 0,
    0, 0, 0, 0,
    0, 0, 0, 0};

#define SCREEN_WIDTH 320
#define SCREEN_HEIGHT 240

#define GAME_STATE_RUN 0

bool gameRunning;

const uint16_t colorCode[] = {TFT_BLACK, TFT_RED, TFT_CYAN, TFT_BLUE, TFT_GREEN, TFT_YELLOW};
const uint8_t WALL = 255;
const int pieSize = 10;
const int boxCols = 15;
const int boxRows = 23;
uint8_t *box;
int score = 0;

const uint16_t blockStroke = 0xAD55;

int nextBlockType = 0;
int nextBlockState = 0;
uint16_t nextBlockColorCode = 0;

int crBlockI, crBlockJ;
int crBlockType;
int crBlockState;
uint16_t crBlockColorCode;

// event will be trigger when  (value > 0) turn to (value <= 0)
const float gravityWaitTime = 0.3;

float gravityRemainTickTime = 1;

//long press
uint8_t keyMask = 255;
float keyboardWaitTime = 0.15;
float goLeftRemainTime = -1;    //disable
float goRightRemainTime = -1;   //disable
float cwRotateRemainTime = -1;  //disable
float icwRotateRemainTime = -1; //disable
float goDownRemainTime = -1;

void drawBlock(int type, int state, int x, int y, uint16_t stroke, uint16_t fill)
{
    for (int i = 0; i < 4; ++i)
        for (int j = 0; j < 4; ++j)
        {
            if (blocks[(type << 6) | (state << 4) | (i << 2) | j])
            {
                M5.Lcd.fillRect(x + j * pieSize + 1, y + i * pieSize + 1, pieSize - 2, pieSize - 2, fill);
                M5.Lcd.drawRect(x + j * pieSize, y + i * pieSize, pieSize, pieSize, stroke);
            }
        }
}

uint8_t getBlockAt(int type, int state, int i, int j)
{
    return blocks[(type << 6) | (state << 4) | (i << 2) | j];
}

uint8_t getBoxAt(uint8_t *box, int i, int j)
{
    if (i >= boxRows || j < 0 || j >= boxCols)
        return WALL;
    if (i < 0)
        return 0;
    return box[i * boxCols + j];
}

uint8_t getBoxAt(int i, int j)
{
    return getBoxAt(box, i, j);
}

void setBoxAt(uint8_t *box, int i, int j, uint8_t value)
{
    if (i < 0 || i >= boxRows || j < 0 || j >= boxCols)
        return;
    box[i * boxCols + j] = value;
}

void setBoxAt(int i, int j, uint8_t value)
{
    setBoxAt(box, i, j, value);
}

bool blockIsHit(uint8_t *box, int type, int state, int iPos, int jPos)
{
    for (int i = 0; i < 4; ++i)
        for (int j = 0; j < 4; ++j)
        {
            if (!getBlockAt(type, state, i, j))
                continue;
            if (iPos + i < 0)
                continue;

            if (iPos + i >= boxRows)
                return true;
            if (getBoxAt(box, iPos + i, jPos + j))
                return true;
        }
    return false;
}

bool blockIsHit(int type, int state, int iPos, int jPos)
{
    return blockIsHit(box, type, state, iPos, jPos);
}

int blockIsOut(int type, int state, int iPos, int jPos)
{
    for (int i = 0; i < 4; ++i)
        for (int j = 0; j < 4; ++j)
        {
            if (!getBlockAt(type, state, i, j))
                continue;
            if (jPos + j < 0)
                return -1;
            if (jPos + j >= boxCols)
                return 1;
        }
    return 0;
}

void drawBlock(int type, int state, int x, int y, uint16_t fill)
{
    for (int i = 0; i < 4; ++i)
        for (int j = 0; j < 4; ++j)
        {
            if (blocks[(type << 6) | (state << 4) | (i << 2) | j])
            {
                M5.Lcd.fillRect(x + j * pieSize, y + i * pieSize, pieSize, pieSize, fill);
            }
        }
}

void drawScore()
{
    M5.Lcd.setTextColor(0xF800, TFT_BLACK);
    M5.Lcd.setTextSize(3);
    M5.Lcd.setCursor(boxCols * pieSize + 2 + 23, 28);
    M5.Lcd.printf("%07d", score);
}
void drawFrame()
{
    M5.Lcd.drawBitmap(SCREEN_WIDTH - 5 - logo_width, SCREEN_HEIGHT - 5 - logo_height, logo_width, logo_height, logo, TFT_BLACK);
    M5.Lcd.drawRect(1, 4 - pieSize, boxCols * pieSize + 2, boxRows * pieSize + pieSize + 2, TFT_WHITE);
    M5.Lcd.setTextSize(2);
    M5.Lcd.setCursor(boxCols * pieSize + 2 + 10, 10);
    M5.Lcd.setTextColor(0xFB40);
    M5.Lcd.print("Score");

    M5.Lcd.drawRect(SCREEN_WIDTH - 20 - pieSize * 4 - 10, 60, pieSize * 4 + 20, pieSize * 4 + 20, 0x8D33);
}

void drawNextBlock()
{
    drawBlock(nextBlockType, nextBlockState, SCREEN_WIDTH - 20 - pieSize * 4, 70, blockStroke, colorCode[nextBlockColorCode]);
}

void drawBlackNextBlock()
{
    drawBlock(nextBlockType, nextBlockState, SCREEN_WIDTH - 20 - pieSize * 4, 70, colorCode[0]);
}

void drawBox()
{
    M5.Lcd.fillRect(2, 5, pieSize * boxCols, pieSize * boxRows, TFT_BLACK);
    int x, y;
    for (int i = 0; i < 345; ++i)
    {
        if (!box[i])
            continue;
        x = 2 + (i % boxCols) * pieSize;
        y = 5 + (i / boxCols) * pieSize;
        M5.Lcd.drawRect(x, y, pieSize, pieSize, blockStroke);
        M5.Lcd.fillRect(x + 1, y + 1, pieSize - 2, pieSize - 2, colorCode[box[i]]);
    }
}

void drawCrBlock()
{
    int x, y;
    x = 2 + pieSize * crBlockJ;
    y = 5 + pieSize * crBlockI;
    drawBlock(crBlockType, crBlockState, x, y, blockStroke, colorCode[crBlockColorCode]);
}

void drawBlackCrBlock()
{
    int x, y;
    x = 2 + pieSize * crBlockJ;
    y = 5 + pieSize * crBlockI;
    drawBlock(crBlockType, crBlockState, x, y, colorCode[0]);
}

void bindCrBlock()
{
    for (int i = 0; i < 4; ++i)
        for (int j = 0; j < 4; ++j)
        {
            if (!blocks[(crBlockType << 6) | (crBlockState << 4) | (i << 2) | j])
                continue;
            if (crBlockI + i < boxRows && crBlockI + i >= 0 && crBlockJ + j < boxCols && crBlockJ + j >= 0)
                box[(crBlockI + i) * 15 + crBlockJ + j] = crBlockColorCode;
        }
}

void dropNewBlock()
{
    drawBlackNextBlock();
    crBlockColorCode = nextBlockColorCode;
    crBlockState = nextBlockState;
    crBlockType = nextBlockType;
    crBlockJ = 6;
    crBlockI = -4;

    nextBlockType = random(7);
    nextBlockState = random(4);
    nextBlockColorCode = 1 + random(5);
    drawNextBlock();
}

void clearBox()
{
    for (int i = 0; i < 345; ++i)
    {
        box[i] = 0;
    }
}

bool canGoDown()
{
    return !blockIsHit(crBlockType, crBlockState, crBlockI + 1, crBlockJ);
}

bool canGoLeft()
{
    return !blockIsHit(crBlockType, crBlockState, crBlockI, crBlockJ - 1);
}

bool canGoRight()
{
    return !blockIsHit(crBlockType, crBlockState, crBlockI, crBlockJ + 1);
}

void goDown()
{
    drawBlackCrBlock();
    crBlockI++;
    drawCrBlock();
}

void goLeft()
{
    drawBlackCrBlock();
    crBlockJ--;
    drawCrBlock();
    printf("go left\n");
}

void goRight()
{
    drawBlackCrBlock();
    crBlockJ++;
    drawCrBlock();
    printf("go right\n");
}

bool cwRotate()
{
    int nState = (crBlockState + 1) % 4;
    int nJ = crBlockJ;
    while (blockIsOut(crBlockType, nState, crBlockI, nJ) < 0)
    {
        nJ++;
    }
    while (blockIsOut(crBlockType, nState, crBlockI, nJ) > 0)
    {
        nJ--;
    }

    if (!blockIsHit(crBlockType, nState, crBlockI, nJ))
    {
        drawBlackCrBlock();
        crBlockJ = nJ;
        crBlockState = nState;
        drawCrBlock();
        return true;
    }
    return false;
}

bool icwRotate()
{
    int nState = (crBlockState + 3) % 4;
    int nJ = crBlockJ;
    while (blockIsOut(crBlockType, nState, crBlockI, nJ) < 0)
    {
        nJ++;
    }
    while (blockIsOut(crBlockType, nState, crBlockI, nJ) > 0)
    {
        nJ--;
    }

    if (!blockIsHit(crBlockType, nState, crBlockI, nJ))
    {
        drawBlackCrBlock();
        crBlockJ = nJ;
        crBlockState = nState;
        drawCrBlock();
        return true;
    }
    return false;
}

void gravityTick()
{
    if (canGoDown())
    {
        goDown();
    }
    else
    {
        bindCrBlock();
        dropNewBlock();
        drawCrBlock();
        drawBox();
    }
}

bool updatePhysic(float dt)
{
    if (goLeftRemainTime > 0)
    {
        goLeftRemainTime -= dt;
        if (goLeftRemainTime <= 0)
        {
            if (canGoLeft())
                goLeft();
            goLeftRemainTime = keyboardWaitTime;
        }
    }

    if (goRightRemainTime > 0)
    {
        goRightRemainTime -= dt;
        if (goRightRemainTime <= 0)
        {
            if (canGoRight())
                goRight();
            goRightRemainTime = keyboardWaitTime;
        }
    }

    if (cwRotateRemainTime > 0)
    {
        cwRotateRemainTime -= dt;
        if (cwRotateRemainTime <= 0)
        {
            cwRotate();
            cwRotateRemainTime = keyboardWaitTime * 1.5;
        }
    }

    if (icwRotateRemainTime > 0)
    {
        icwRotateRemainTime -= dt;
        if (icwRotateRemainTime <= 0)
        {
            icwRotate();
            icwRotateRemainTime = keyboardWaitTime * 1.5;
        }
    }

    bool needtriggerGravity = false;
    if (gravityRemainTickTime > 0)
    {
        gravityRemainTickTime -= dt;
        if (gravityRemainTickTime <= 0)
        {
            needtriggerGravity = true;
        }
    }

    if (goDownRemainTime > 0)
    {
        goDownRemainTime -= dt;
        if (goDownRemainTime <= 0)
        {
            needtriggerGravity = true;
            goDownRemainTime = keyboardWaitTime / 3;
        }
    }
    if (needtriggerGravity)
    {
        gravityTick();
        gravityRemainTickTime = gravityWaitTime;
    }
    return true;
}

bool updateScore(float dt)
{
    int bottom = boxRows - 1;
    int fullRows = 0;
    for (int i = boxRows - 1; i >= -1; --i)
    {
        int s = 0;
        for (int j = 0; j < boxCols; ++j)
        {
            if (getBoxAt(i, j))
                ++s;
        }
        if (s < boxCols)
        {
            //
            if (bottom != i)
            {
                for (int j = 0; j < boxCols; ++j)
                {
                    setBoxAt(bottom, j, getBoxAt(i, j));
                }
            }
            bottom--;
        }
        else {
            fullRows++;
        }
    }
    if (fullRows > 0){
        score += 1<<fullRows;
        drawScore();
        drawBox();
        drawCrBlock();
        return true;
    }
    else{
        if (bottom <0){

        }
        return false;
    }

}

void update(float dt)
{
    if (gameRunning)
    {
        if (updateScore(dt))
        {
            // NOOP
        }
        else
            updatePhysic(dt);
    }
}

void handleKeyboard(uint8_t key)
{
    keyMask = ~key;
    if (!(key & G_KEY_START))
    {
        gameRunning = !gameRunning;
    }
    if (gameRunning)
    {
        if (!(key & G_KEY_LEFT))
        {
            if (canGoLeft())
                goLeft();
            goLeftRemainTime = keyboardWaitTime * 1.5; //long press
        }
        else
        {
            goLeftRemainTime = -1;
        }
        if (!(key & G_KEY_RIGHT))
        {
            if (canGoRight())
                goRight();
            goRightRemainTime = keyboardWaitTime * 1.5; //long press
        }
        else
        {
            goRightRemainTime = -1;
        }

        if (!(key & G_KEY_DOWN))
        {
            if (canGoDown())
                goDown();
            goDownRemainTime = keyboardWaitTime / 3; //faster
        }
        else
        {
            goDownRemainTime = -1;
        }

        if (!(key & G_KEY_A))
        {
            cwRotate();
            cwRotateRemainTime = keyboardWaitTime * 1.5; // slower delay
        }
        else
        {
            cwRotateRemainTime = -1;
        }
        if (!(key & G_KEY_B))
        {
            icwRotate();
            icwRotateRemainTime = keyboardWaitTime * 1.5; // slower delay
        }
        else
        {
            icwRotateRemainTime = -1;
        }
    }
}

void init()
{
    box = new uint8_t[345];
    M5.Lcd.clear();
    gDrawFunc(NULL);
    gUpdateFunc(&update);
    gKeyboardFunc(&handleKeyboard);

    drawFrame();

    drawScore();

    clearBox();
    dropNewBlock();
    dropNewBlock();

    drawNextBlock();
    drawBox();
    gameRunning = true;
}

void destroy()
{
    delete box;
    gDrawFunc(NULL);
    gUpdateFunc(NULL);
    gKeyboardFunc(NULL);
}

} // namespace tetris

#endif //TETRIS
